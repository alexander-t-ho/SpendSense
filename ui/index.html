<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="alternate icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leafly - Money doesn't grow on trees</title>
  </head>
  <body>
    <div id="root"></div>
    <!-- Early error suppression for browser extensions - must run before any other scripts -->
    <script>
      (function() {
        'use strict';
        
        // Helper to check if message should be suppressed
        function shouldSuppress(message) {
          if (!message) return false;
          var lower = message.toLowerCase();
          
          // Check for runtime.lastError variations
          if (lower.includes('runtime.lasterror') || 
              lower.includes('unchecked runtime.lasterror') ||
              lower.includes('cannot create item with duplicate id') ||
              lower.includes('duplicate id')) {
            return true;
          }
          
          // Check for LastPass and password manager errors
          if (lower.includes('lastpass') || 
              lower.includes('lp-push-server') ||
              lower.includes('background-redux')) {
            return true;
          }
          
          // Check for context menu items
          var contextMenuItems = [
            'add item', 'add password', 'add address', 'add payment card',
            'add other item', 'save all entered data', 'generate secure password',
            'separator', 'fill -', 'edit -', 'copy first name', 'copy last name',
            'copy address line', 'copy city', 'copy town', 'copy zip', 'copy postal code',
            'copy email address', 'copy phone number', 'copy city/town', 'copy zip/postal code'
          ];
          if (contextMenuItems.some(function(item) { return lower.includes(item); })) {
            return true;
          }
          
          // Check for numeric IDs in duplicate id errors
          if (lower.includes('duplicate id') && /\d{10,}/.test(message)) {
            return true;
          }
          
          // Check for extension URLs
          if (lower.includes('chrome-extension://') ||
              lower.includes('moz-extension://') ||
              lower.includes('safari-extension://') ||
              lower.includes('extension://')) {
            return true;
          }
          
          // Check for WebSocket errors from extensions
          if (lower.includes('websocket') && 
              (lower.includes('lastpass') || lower.includes('lp-push-server'))) {
            return true;
          }
          
          return false;
        }
        
        // Suppress console.error
        var originalError = console.error;
        console.error = function() {
          var message = Array.prototype.join.call(arguments, ' ');
          if (shouldSuppress(message)) return;
          originalError.apply(console, arguments);
        };
        
        // Suppress console.warn
        var originalWarn = console.warn;
        console.warn = function() {
          var message = Array.prototype.join.call(arguments, ' ');
          if (shouldSuppress(message)) return;
          originalWarn.apply(console, arguments);
        };
        
        // Suppress console.log (some extensions use this)
        var originalLog = console.log;
        console.log = function() {
          var message = Array.prototype.join.call(arguments, ' ');
          if (shouldSuppress(message)) return;
          originalLog.apply(console, arguments);
        };
        
        // Suppress unhandled promise rejections
        window.addEventListener('unhandledrejection', function(event) {
          var reason = event.reason ? (event.reason.message || event.reason.toString() || '') : '';
          var stack = event.reason && event.reason.stack ? event.reason.stack : '';
          
          if (shouldSuppress(reason) || shouldSuppress(stack) ||
              reason.toLowerCase().includes('no tab with id') ||
              reason.toLowerCase().includes('message channel closed') ||
              reason.toLowerCase().includes('extension context invalidated')) {
            event.preventDefault();
            return;
          }
        }, true); // Use capture phase to catch early
        
        // Suppress general errors
        window.addEventListener('error', function(event) {
          var message = event.message || '';
          var source = event.filename || '';
          if (shouldSuppress(message) || shouldSuppress(source) ||
              source.includes('chrome-extension://') ||
              source.includes('moz-extension://') ||
              source.includes('background-redux')) {
            event.preventDefault();
            return false;
          }
        }, true);
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>

